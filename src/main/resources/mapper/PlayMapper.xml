<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="kr.co.crevill.play.PlayMapper">
	
	<select id="selectPlayCount" parameterType="kr.co.crevill.play.PlayDto" resultType="Integer">
        SELECT COUNT(*)
          FROM PLAY
    </select>
	
    <select id="selectPlayList" parameterType="kr.co.crevill.play.PlayDto" resultType="kr.co.crevill.play.PlayVo">
        SELECT A.PLAY_ID,
		       A.NAME,
		       A.DESCRIPTION,
		       A.PLAY_TIME,
		       A.OPERATION_TYPE,
		       A.THUMBNAIL_IDX,
		       A.PICTURE_IDX,
		       B.DATA THUMBNAIL,
		       B.IMAGE_NAME THUMBNAIL_NAME,
			   B.IMAGE_SIZE THUMBNAIL_SIZE,
		       C.DATA PICTURE,
		       C.IMAGE_NAME PICTURE_NAME,
			   C.IMAGE_SIZE PICTURE_SIZE,
		       A.REG_ID,
		       DATE_FORMAT(A.REG_DATE, '%Y/%m/%d') REG_DATE,
		       A.UPD_ID,
		       DATE_FORMAT(A.UPD_DATE, '%Y/%m/%d') UPD_DATE	
          FROM PLAY A
               LEFT OUTER JOIN IMAGES B ON A.THUMBNAIL_IDX = B.IMAGE_IDX
               LEFT OUTER JOIN IMAGES C ON A.PICTURE_IDX = C.IMAGE_IDX
         LIMIT #{startPage}, #{recordsPerPage}
    </select>
	
	<insert id="insertPlay" parameterType="kr.co.crevill.play.PlayDto">
    	INSERT INTO PLAY (
   					      PLAY_ID,
					      NAME,
					      DESCRIPTION,
					      PLAY_TIME,
					      OPERATION_TYPE,
					      THUMBNAIL_IDX,
					      PICTURE_IDX,
					      REG_ID,
					      REG_DATE						
   						 )
				  VALUES (
				  		  #{playId},
					      #{name},
					      #{description},
					      #{playTime},
					      #{operationType},
					      #{thumbnailIdx},
					      #{pictureIdx},
					      #{regId},
					      NOW()
				   		 )
    </insert>
	
</mapper>