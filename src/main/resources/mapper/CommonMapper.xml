<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="kr.co.crevill.common.CommonMapper">
	
    <select id="selectCommonCode" parameterType="kr.co.crevill.common.CommonCodeDto" resultType="kr.co.crevill.common.CommonCodeVo">
        SELECT CODE_TYPE,
        	   CODE_KEY,
        	   CODE_VALUE,
        	   REG_ID,
        	   REG_DATE,
        	   UPD_ID,
        	   UPD_DATE
          FROM COMMON_CODE
        <where>
			<if test="codeType != null">AND CODE_TYPE = #{codeType} </if>
			<if test="codeKey != null">AND CODE_KEY = #{codeKey} </if>
			<if test="codeValue != null">AND CODE_VALUE = #{codeValue} </if>
		</where>
    </select>
	
	 <select id="selectNationalCode" resultType="kr.co.crevill.common.CommonCodeVo">
        SELECT CODE_TYPE,
        	   CODE_KEY,
        	   CODE_VALUE,
        	   REG_ID,
        	   REG_DATE,
        	   UPD_ID,
        	   UPD_DATE,
        	   CASE WHEN CODE_KEY  = 'US' THEN 1
        	        WHEN CODE_KEY  = 'GB' THEN 2
        	        WHEN CODE_KEY  = 'CA' THEN 3
        	        WHEN CODE_KEY  = 'AU' THEN 4
        	        WHEN CODE_KEY  = 'HK' THEN 5
        	        WHEN CODE_KEY  = 'SG' THEN 6
        	        WHEN CODE_KEY  = 'ETC' THEN 7 END AS SORDER
          FROM COMMON_CODE
         WHERE CODE_TYPE = 'NATIONALITY'
      ORDER BY SORDER
    </select>
	
	<select id="selectOfficeList" resultType="kr.co.crevill.common.OfficeInfoVo">
		SELECT OFFICE_ID,
			   OFFICE_NAME,
			   OFFICE_DESCRIPTION,
			   TEL_NO,
			   SORT_RANK
		  FROM OFFICE_INFO
	  ORDER BY SORT_RANK 
	</select>
	
	<select id="selectImageInfo" parameterType="kr.co.crevill.common.FileDto" resultType="kr.co.crevill.common.FileVo">
		SELECT IMAGE_IDX,
			   DATA,
			   DESCRIPTION,
			   IMAGE_NAME,
			   IMAGE_SIZE
		  FROM IMAGES
	     WHERE IMAGE_IDX = #{imageIdx} 
	</select>
	
	<select id="selectImagesIdx" resultType="kr.co.crevill.common.FileVo">
		SELECT IFNULL(IMAGES_IDX_SEQ_NEXTVAL(), 1) IMAGE_IDX
	</select>
	
	<select id="selectFileIdx" resultType="kr.co.crevill.common.FileVo">
		SELECT IFNULL(FILES_IDX_SEQ_NEXTVAL(), 1) FILE_IDX
	</select>
	
	<insert id="insertImages" parameterType="kr.co.crevill.common.FileDto">
		INSERT INTO IMAGES(
						   IMAGE_IDX,
						   DATA,
						   DESCRIPTION,
						   IMAGE_NAME,
						   IMAGE_SIZE
						  )
				   VALUES (
				   		   #{imageIdx},
						   #{data},
						   #{description},
						   #{fileName},
						   #{fileSize}	
				   		  )		  
	</insert>
	
	<insert id="insertFiles" parameterType="kr.co.crevill.common.FileDto">
		INSERT INTO FILES(
						   FILE_IDX,
						   DATA,
						   DESCRIPTION,
						   FILE_NAME,
						   FILE_SIZE
						  )
				   VALUES (
				   		   #{fileIdx},
						   #{data},
						   #{description},
						   #{fileName},
						   #{fileSize}	
				   		  )		  
	</insert>
		
</mapper>